# CodeClarity Development Environment

<br>

<div align="center">
    <img src="https://user-images.githubusercontent.com/124595411/235138790-d86cc2b8-e3ef-43eb-846c-38055748c9db.svg" width="400px" />
</div>

<br>

## Overview

This repository contains all the necessary tools and dependencies to develop on CodeClarity. It includes Docker containers, build scripts, and configuration files required to set up your local development environment.

## License

This project is licensed under the AGPL-3.0-or-later license. See [LICENSE](./LICENSE) for details.

## Requirements

- curl
- make
- [golang >= 1.22](https://go.dev/dl/)
- [docker](https://docs.docker.com/engine/install/)
- [docker compose](https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-compose-on-ubuntu-20-04)

## Setup Instructions

### 1. Clone this repository recursively

```bash
git clone git@github.com:CodeClarityCE/codeclarity-dev.git --recursive
```

### 2. Navigate to the project directory

```bash
cd codeclarity-dev
```

### 3. Create your .netrc file (Optional)

If you need access to a private Go library, create a [personal access token](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens) and run the following command:

```bash
echo "machine github.com login YOUR_GITHUB_LOGIN password ghp_***************" > backend/.cloud/docker/config/.netrc
```

Once this project is public, this won't be needed anymore.

### 4. Build the project

Run the following command in your terminal:

```bash
make build
```

This will compile and install all dependencies necessary for development.

### 5. Start the containers

Start the required services with the following commands:

```bash
make up
```

### 6. Initialize DB

Run this command to create the databases in Postgres:

```bash
make download-dumps
make knowledge-setup
make restore-database
```

### 7. Update DB (Optional)

Please apply for an NVD API key [here](https://nvd.nist.gov/developers/request-an-api-key), and fill it in `codeclarity-dev/.cloud/env/.env.makefile`.

Run the command to update the knowledge DB:

```bash
make knowledge-update
```

### 9. Restart the containers

Restart containers to be sure that all the containers connect to the DB

```bash
make down && make up
```

Your development environment is now set up.

## Start using the platform

You can visit [https://localhost:443](https://localhost:443) to start using the platform. You might need to accept the self-signed certificate generated by Caddy.

If you imported the dump we provide, you can connect using the following credentials:

- login: `john.doe@codeclarity.io`
- password: `ThisIs4Str0ngP4ssW0rd?`

Now, follow [this guide](https://www.codeclarity.io/docs/createanalysis) to create your first analysis!

## Contributing

If you'd like to contribute code or documentation, please see [CONTRIBUTING.md](./CONTRIBUTING.md) for guidelines on how to do so.

## Reporting Issues

Please report any issues with the setup process or other problems encountered while using this repository by opening a new issue in this project's GitHub page.
